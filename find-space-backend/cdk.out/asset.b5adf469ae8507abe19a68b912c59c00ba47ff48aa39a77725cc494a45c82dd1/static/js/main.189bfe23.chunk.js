(this["webpackJsonpfind-space-frontend"]=this["webpackJsonpfind-space-frontend"]||[]).push([[0],{159:function(e,t,n){},625:function(e,t,n){},626:function(e,t,n){},627:function(e,t,n){"use strict";n.r(t);var r=n(6),a=n.n(r),s=n(136),c=n.n(s),i=(n(159),n(14)),o=n(9),u=n(10),p=n(36),l=n(16),h=n(17),j=n(8),b=n.n(j),d=n(64),f=n(147),O=n(137),v=n(146),x="https://z9ym4hobkb.execute-api.us-east-1.amazonaws.com/prod/",m={REGION:"us-east-1",USER_POOL_ID:"us-east-1_PsL2fDE44",APP_CLIENT_ID:"6n65p0532shng7hjuo9lhlh6j2",IDENTITY_POOL_ID:"us-east-1:90f61513-6cb6-41ac-a722-f2ee20bce693",PHOTO_BUCKET:"space-photos-1216df61bb73",api:{baseURL:x,spaceURL:"".concat(x,"spaces")},TEST_USER_NAME:"findspaceapp",TEST_USER_PASSWORD:"zaq1@WSX"},g=n(37);O.default.configure({Auth:{mandatorySignIn:!1,region:m.REGION,userPoolId:m.USER_POOL_ID,identityPoolId:m.IDENTITY_POOL_ID,userPoolWebClientId:m.APP_CLIENT_ID,authenticationFlowType:"USER_PASSWORD_AUTH"}});var y=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,[{key:"login",value:function(){var e=Object(i.a)(b.a.mark((function e(t,n){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.signIn(t,n);case 3:return r=e.sent,e.abrupt("return",{userName:r.getUsername(),cognitoUser:r});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var e=Object(i.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,v.a.userAttributes(t.cognitoUser);case 3:return r=e.sent,console.log(JSON.stringify(r)),n.push.apply(n,Object(f.a)(r)),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAWSTemporyCreds",value:function(){var e=Object(i.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="cognito-idp.".concat(m.REGION,".amazonaws.com/").concat(m.USER_POOL_ID),g.config.credentials=new g.CognitoIdentityCredentials({IdentityPoolId:m.IDENTITY_POOL_ID,Logins:Object(d.a)({},n,t.getSignInUserSession().getIdToken().getJwtToken())},{region:m.REGION}),e.next=4,this.refreshCredientials();case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"refreshCredientials",value:function(){var e=Object(i.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){g.config.credentials.refresh((function(n){n?t(n):e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),S=n(21),k=Object(S.a)(),w=n(4),I=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={userName:"",password:"",loginAttempted:!1,loginSuccessful:!1},e}return Object(u.a)(n,[{key:"setUserName",value:function(e){this.setState({userName:e.target.value})}},{key:"setPassword",value:function(e){this.setState({password:e.target.value})}},{key:"handleSubmit",value:function(){var e=Object(i.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,this.props.authService.login(this.state.userName,this.state.password);case 3:(n=e.sent)?(this.setState({loginAttempted:!0,loginSuccessful:!0}),this.props.setUser(n),k.push("/profile")):this.setState({loginAttempted:!0,loginSuccessful:!1});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this;return this.state.loginAttempted&&(e=this.state.loginSuccessful?Object(w.jsx)("label",{children:"Login successfule"}):Object(w.jsx)("label",{children:"Login failed"})),Object(w.jsxs)("div",{children:[Object(w.jsx)("h2",{children:"Please login"}),Object(w.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(w.jsx)("input",{value:this.state.userName,onChange:function(e){return t.setUserName(e)}}),Object(w.jsx)("br",{}),Object(w.jsx)("input",{value:this.state.password,type:"password",onChange:function(e){return t.setPassword(e)}}),Object(w.jsx)("br",{}),Object(w.jsx)("input",{type:"submit",value:"Login"})]}),e]})}}]),n}(a.a.Component),U=n(13),N=n(28),C=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e;return e=this.props.user?Object(w.jsx)(N.a,{to:"/logout",style:{float:"right"},children:this.props.user.userName}):Object(w.jsx)(N.a,{to:"/login",style:{float:"right"},children:"Login"}),Object(w.jsxs)("div",{className:"navbar",children:[Object(w.jsx)(N.a,{to:"/",children:"Home"}),Object(w.jsx)(N.a,{to:"/profile",children:"Profile"}),Object(w.jsx)(N.a,{to:"/spaces",children:"Spaces"}),e]})}}]),n}(a.a.Component),L=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(w.jsx)("div",{children:"Welcome to home page"})}}]),n}(a.a.Component),P=n(70),R=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={userAttributes:[]},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.user){e.next=5;break}return e.next=3,this.props.authService.getUserAttributes(this.props.user);case 3:t=e.sent,this.setState({userAttributes:t});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderUserAttributes",value:function(){var e,t=[],n=Object(P.a)(this.state.userAttributes);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:r.Name}),Object(w.jsx)("td",{children:r.Value})]},r.Name))}}catch(a){n.e(a)}finally{n.f()}return Object(w.jsx)("table",{children:Object(w.jsx)("tbody",{children:t})})}},{key:"render",value:function(){var e;return e=this.props.user?Object(w.jsxs)("div",{children:[Object(w.jsxs)("h3",{children:[" hello ",this.props.user.userName]}),"Here are your UserAttributes:",this.renderUserAttributes()]}):Object(w.jsxs)("div",{children:["Please ",Object(w.jsx)(N.a,{to:"/login",children:"Login"})]}),Object(w.jsxs)("div",{children:["Welcome to profile page",e]})}}]),n}(a.a.Component),A=n(145),E=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={name:"",description:"",location:"",photoURL:""},e}return Object(u.a)(n,[{key:"setName",value:function(e){this.setState({name:e.target.value})}},{key:"setLocation",value:function(e){this.setState({location:e.target.value})}},{key:"setDescription",value:function(e){this.setState({description:e.target.value})}},{key:"setPhotoUrl",value:function(e){e.target.files&&e.target.files[0]&&this.setState({photo:e.target.files[0]})}},{key:"handleSubmit",value:function(){var e=Object(i.a)(b.a.mark((function e(t){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=Object(A.a)({},this.state),e.prev=2,e.next=5,this.props.dataService.createSpace(n);case 5:r=e.sent,alert("created space with id ".concat(r)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),alert("Error while creating space:  ".concat(e.t0.message)),console.error(e.t0);case 13:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t=this;if(this.state.photo){var n=URL.createObjectURL(this.state.photo);e=Object(w.jsx)("img",{alt:"",src:n})}else e=Object(w.jsx)("div",{});return Object(w.jsxs)("form",{onSubmit:function(e){return t.handleSubmit(e)},children:[Object(w.jsxs)("label",{children:["Name:",Object(w.jsx)("br",{}),Object(w.jsx)("input",{name:"space name",value:this.state.name,onChange:function(e){return t.setName(e)}})]}),Object(w.jsx)("br",{}),Object(w.jsxs)("label",{children:["Location:",Object(w.jsx)("br",{}),Object(w.jsx)("input",{name:"space location",value:this.state.location,onChange:function(e){return t.setLocation(e)}})]}),Object(w.jsx)("br",{}),Object(w.jsxs)("label",{children:["Description:",Object(w.jsx)("br",{}),Object(w.jsx)("input",{name:"space location",value:this.state.description,onChange:function(e){return t.setDescription(e)}})]}),Object(w.jsx)("br",{}),Object(w.jsxs)("label",{children:["Photo:",Object(w.jsx)("br",{}),Object(w.jsx)("input",{name:"photo",type:"file",onChange:function(e){return t.setPhotoUrl(e)}})]}),Object(w.jsx)("br",{}),e,Object(w.jsx)("br",{}),Object(w.jsx)("input",{"data-test":"submit-button",type:"submit",value:"Create space"})]})}}]),n}(r.Component);g.config.update({region:m.REGION});var T=function(){function e(){Object(o.a)(this,e)}return Object(u.a)(e,[{key:"getSpaces",value:function(){var e=Object(i.a)(b.a.mark((function e(){var t,n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.api.spaceURL,e.next=3,fetch(t,{method:"GET"});case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,console.log(JSON.stringify(r)),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"reserveSpace",value:function(){var e=Object(i.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("1234"!==t){e.next=4;break}return e.abrupt("return","555");case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSpace",value:function(){var e=Object(i.a)(b.a.mark((function e(t){var n,r,a,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.photo){e.next=6;break}return e.next=3,this.uploadPublicFile(t.photo,m.PHOTO_BUCKET);case 3:n=e.sent,t.photoURL=n,t.photo=void 0;case 6:return r=m.api.spaceURL,a={method:"POST",body:JSON.stringify(t)},e.next=10,fetch(r,a);case 10:return s=e.sent,console.log(s),e.next=14,s.json();case 14:return c=e.sent,console.log(c),e.abrupt("return",JSON.stringify(c.spaceid));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadPublicFile",value:function(){var e=Object(i.a)(b.a.mark((function e(t,n){var r,a,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.random().toString(36).slice(2)+t.name,e.prev=1,a=new g.S3({region:m.REGION}),e.next=5,a.upload({Bucket:n,Key:r,Body:t,ACL:"public-read"}).promise();case 5:return s=e.sent,e.abrupt("return",s.Location);case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),_=n.p+"static/media/defaultBuilding.9e7aeda0.jpg",D=(n(625),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"renderImage",value:function(){return this.props.photoURL?Object(w.jsx)("img",{src:this.props.photoURL,alt:this.props.name}):Object(w.jsx)("img",{src:_,alt:this.props.name})}},{key:"render",value:function(){var e=this;return Object(w.jsxs)("div",{className:"spaceComponent",children:[this.renderImage(),Object(w.jsx)("label",{className:"name",children:this.props.name}),Object(w.jsx)("br",{}),Object(w.jsx)("label",{className:"spaceId",children:this.props.spaceId}),Object(w.jsx)("br",{}),Object(w.jsx)("label",{className:"location",children:this.props.location}),Object(w.jsx)("br",{}),Object(w.jsx)("button",{onClick:function(){return e.props.reserveSpace(e.props.spaceId)},children:"Reserve"}),Object(w.jsx)("br",{})]},this.props.spaceId)}}]),n}(r.Component)),M=(n(626),function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return this.props.show?Object(w.jsx)("div",{className:"modal",children:Object(w.jsxs)("div",{className:"modal-content",children:[Object(w.jsx)("h2",{children:"You tried to reserve and ..."}),Object(w.jsx)("h3",{className:"modalText",children:this.props.content}),Object(w.jsx)("button",{onClick:function(){return e.props.close()},children:"Ok. Close"})]})}):null}}]),n}(r.Component)),W=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).state={spaces:[],showModal:!1,modalContent:""},r.reserveSpace=r.reserveSpace.bind(Object(p.a)(r)),r.closeModal=r.closeModal.bind(Object(p.a)(r)),r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(i.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dataService.getSpaces();case 2:t=e.sent,this.setState({spaces:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reserveSpace",value:function(){var e=Object(i.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.dataService.reserveSpace(t);case 2:(n=e.sent)?this.setState({showModal:!0,modalContent:"You reserved space id ".concat(t," and confimed number ").concat(n)}):this.setState({showModal:!0,modalContent:"You can not reserve space id ".concat(t)});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeModal",value:function(){this.setState({showModal:!1,modalContent:""})}},{key:"renderSpaces",value:function(){var e,t=[],n=Object(P.a)(this.state.spaces);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(Object(w.jsx)(D,{spaceId:r.spaceId,name:r.name,location:r.location,photoURL:r.photoURL,reserveSpace:this.reserveSpace},r.spaceId))}}catch(a){n.e(a)}finally{n.f()}return t}},{key:"render",value:function(){return Object(w.jsxs)("div",{children:[Object(w.jsx)("h2",{children:"Welcome to the spaces page"}),Object(w.jsx)(N.a,{to:"/createSpace",children:"Create Space"}),Object(w.jsx)("br",{}),this.renderSpaces(),Object(w.jsx)(M,{show:this.state.showModal,content:this.state.modalContent,close:this.closeModal})]})}}]),n}(r.Component),G=function(e){Object(l.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).authService=new y,r.dataService=new T,r.state={user:void 0},r.setUser=r.setUser.bind(Object(p.a)(r)),r}return Object(u.a)(n,[{key:"setUser",value:function(){var e=Object(i.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({user:t}),e.next=3,this.authService.getAWSTemporyCreds(t.cognitoUser);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(w.jsx)("div",{className:"wrapper",children:Object(w.jsx)(U.b,{history:k,children:Object(w.jsxs)("div",{children:[Object(w.jsx)(C,{user:this.state.user}),Object(w.jsxs)(U.c,{children:[Object(w.jsx)(U.a,{exact:!0,path:"/",component:L}),Object(w.jsx)(U.a,{exact:!0,path:"/login",children:Object(w.jsx)(I,{authService:this.authService,setUser:this.setUser})}),Object(w.jsx)(U.a,{exact:!0,path:"/profile",children:Object(w.jsx)(R,{authService:this.authService,user:this.state.user})}),Object(w.jsx)(U.a,{exact:!0,path:"/spaces",children:Object(w.jsx)(W,{dataService:this.dataService})}),Object(w.jsx)(U.a,{exact:!0,path:"/createSpace",children:Object(w.jsx)(E,{dataService:this.dataService})})]})]})})})}}]),n}(a.a.Component);c.a.render(Object(w.jsx)(G,{}),document.getElementById("root"))},84:function(e,t){}},[[627,1,2]]]);
//# sourceMappingURL=main.189bfe23.chunk.js.map